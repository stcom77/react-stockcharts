{"version":3,"sources":["../../../../src/lib/interactive/components/InteractivePriceCoordinate.js"],"names":["InteractivePriceCoordinate","props","renderSVG","bind","drawOnCanvas","isHover","moreProps","onHover","selected","helper","x1","x2","y","rect","mouseXY","mouseX","mouseY","x","width","height","Math","abs","ctx","bgFill","bgOpacity","textFill","fontFamily","fontSize","fontStyle","fontWeight","hovering","fillStyle","strokeStyle","beginPath","lineWidth","setLineDash","moveTo","lineTo","stroke","fillRect","strokeRect","textBaseline","textAlign","font","fillText","Error","interactiveCursorClass","onUnHover","onDragStart","onDrag","onDragComplete","yValue","chartConfig","yScale","round","propTypes","string","isRequired","number","oneOfType","text","func","defaultClassName","tolerance","bool","defaultProps","type","strokeWidth"],"mappings":"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","file":"InteractivePriceCoordinate.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport GenericChartComponent from \"../../GenericChartComponent\";\nimport { getMouseCanvas } from \"../../GenericComponent\";\nimport { isDefined, noop, hexToRGBA, getStrokeDasharrayCanvas } from \"../../utils\";\n\nclass InteractivePriceCoordinate extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t\tthis.isHover = this.isHover.bind(this);\n\t}\n\tisHover(moreProps) {\n\t\tconst { onHover, selected } = this.props;\n\n\t\tif (isDefined(onHover)) {\n\t\t\tconst { x1, x2, y, rect } = helper(this.props, moreProps);\n\t\t\tconst { mouseXY: [mouseX, mouseY] } = moreProps;\n\n\t\t\tif (\n\t\t\t\tselected\n\t\t\t\t&& mouseX >= rect.x\n\t\t\t\t&& mouseX <= rect.x + rect.width\n\t\t\t\t&& mouseY >= rect.y\n\t\t\t\t&& mouseY <= rect.y + rect.height\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tx1 <= mouseX\n\t\t\t\t&& x2 >= mouseX\n\t\t\t\t&& Math.abs(mouseY - y) < 4\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tconst {\n\t\t\tbgFill,\n\t\t\tbgOpacity,\n\t\t\ttextFill,\n\t\t\tfontFamily,\n\t\t\tfontSize,\n\t\t\tfontStyle,\n\t\t\tfontWeight,\n\t\t} = this.props;\n\n\t\tconst { selected, hovering } = this.props;\n\n\t\tconst { x1, x2, y, rect } = helper(this.props, moreProps);\n\n\t\tctx.fillStyle = hexToRGBA(bgFill, bgOpacity);\n\t\tctx.strokeStyle = textFill;\n\n\t\tctx.beginPath();\n\t\tif (selected || hovering) {\n\t\t\tctx.lineWidth = 2;\n\t\t\tctx.setLineDash(getStrokeDasharrayCanvas(\"LongDash\"));\n\t\t\tctx.moveTo(x1, y);\n\t\t\tctx.lineTo(rect.x, y);\n\n\t\t\tctx.moveTo(rect.x + rect.width, y);\n\t\t\tctx.lineTo(x2, y);\n\t\t\tctx.stroke();\n\n\t\t\tctx.setLineDash([]);\n\t\t\tctx.fillRect(rect.x, rect.y, rect.width, rect.height);\n\t\t\tctx.strokeRect(rect.x, rect.y, rect.width, rect.height);\n\n\t\t\tctx.fillStyle = textFill;\n\t\t\tctx.textBaseline = \"middle\";\n\t\t\tctx.textAlign = \"start\";\n\t\t\tctx.font = `${fontStyle} ${fontWeight} ${fontSize}px ${fontFamily}`;\n\t\t\tctx.beginPath();\n\t\t\tctx.fillText(\"Alert\", rect.x + 10, y);\n\t\t} else {\n\t\t\tctx.setLineDash(getStrokeDasharrayCanvas(\"ShortDash\"));\n\t\t\tctx.moveTo(x1, y);\n\t\t\tctx.lineTo(x2, y);\n\t\t\tctx.stroke();\n\t\t}\n\t}\n\trenderSVG() {\n\t\tthrow new Error(\"svg not implemented\");\n\t}\n\trender() {\n\t\tconst { selected, interactiveCursorClass } = this.props;\n\t\tconst { onHover, onUnHover } = this.props;\n\t\tconst { onDragStart, onDrag, onDragComplete } = this.props;\n\n\t\treturn (\n\t\t\t<GenericChartComponent\n\t\t\t\tisHover={this.isHover}\n\n\t\t\t\tsvgDraw={this.renderSVG}\n\t\t\t\tcanvasToDraw={getMouseCanvas}\n\t\t\t\tcanvasDraw={this.drawOnCanvas}\n\n\t\t\t\tinteractiveCursorClass={interactiveCursorClass}\n\t\t\t\tselected={selected}\n\t\t\t\tenableDragOnHover\n\n\t\t\t\tonDragStart={onDragStart}\n\t\t\t\tonDrag={onDrag}\n\t\t\t\tonDragComplete={onDragComplete}\n\t\t\t\tonHover={onHover}\n\t\t\t\tonUnHover={onUnHover}\n\n\t\t\t\tdrawOn={[\"mousemove\", \"mouseleave\", \"pan\", \"drag\"]}\n\t\t\t/>\n\t\t);\n\t}\n}\n\nfunction helper(props, moreProps) {\n\tconst { yValue } = props;\n\n\tconst { chartConfig: { width, yScale } } = moreProps;\n\n\tconst y = Math.round(yScale(yValue));\n\tconst height = 24;\n\tconst rect = {\n\t\tx: 20,\n\t\ty: y - height / 2,\n\t\twidth: 80,\n\t\theight,\n\t};\n\treturn {\n\t\tx1: 0,\n\t\tx2: width,\n\t\ty,\n\t\trect,\n\t};\n}\n\nInteractivePriceCoordinate.propTypes = {\n\tbgFill: PropTypes.string.isRequired,\n\tbgOpacity: PropTypes.number.isRequired,\n\n\ttextFill: PropTypes.string.isRequired,\n\tfontFamily: PropTypes.string.isRequired,\n\tfontSize: PropTypes.number.isRequired,\n\tfontWeight: PropTypes.oneOfType([\n\t\tPropTypes.number,\n\t\tPropTypes.string,\n\t]).isRequired,\n\tfontStyle: PropTypes.string.isRequired,\n\n\ttext: PropTypes.string.isRequired,\n\n\tonDragStart: PropTypes.func.isRequired,\n\tonDrag: PropTypes.func.isRequired,\n\tonDragComplete: PropTypes.func.isRequired,\n\tonHover: PropTypes.func,\n\tonUnHover: PropTypes.func,\n\n\tdefaultClassName: PropTypes.string,\n\tinteractiveCursorClass: PropTypes.string,\n\n\ttolerance: PropTypes.number.isRequired,\n\tselected: PropTypes.bool.isRequired,\n\thovering: PropTypes.bool.isRequired,\n};\n\nInteractivePriceCoordinate.defaultProps = {\n\tonDragStart: noop,\n\tonDrag: noop,\n\tonDragComplete: noop,\n\n\ttype: \"SD\", // standard dev\n\tfontWeight: \"normal\", // standard dev\n\n\tstrokeWidth: 1,\n\ttolerance: 4,\n\tselected: false,\n\thovering: false,\n};\n\nexport default InteractivePriceCoordinate;"]}