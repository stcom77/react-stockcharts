{"version":3,"sources":["../../../../src/lib/interactive/InteractiveYCoordinate.js"],"names":["React","Component","PropTypes","format","isDefined","noop","strokeDashTypes","getValueFromOverride","terminate","saveNodeType","isHoverForInteractiveType","EachInteractiveYCoordinate","HoverTextNearMouse","InteractiveYCoordinate","props","handleDrag","bind","handleDragComplete","getSelectionState","nodes","state","index","yValue","setState","override","moreProps","yCoordinateList","newAlertList","map","each","idx","selected","draggedAlert","onDragComplete","xyValue","current","start","end","onDelete","propTypes","onChoosePosition","func","isRequired","onSelect","defaultPriceCoordinate","shape","bgFill","string","bgOpacity","number","stroke","strokeDasharray","oneOf","strokeOpacity","strokeWidth","textFill","fontFamily","fontWeight","fontStyle","fontSize","text","textWidth","textBox","height","left","width","padding","right","closeIcon","edge","fill","fillOpacity","hoverText","object","array","enabled","bool","defaultProps","orient","at","arrowWidth","dx","rectWidth","rectHeight","displayFormat","enable","bgHeight","bgWidth","contextTypes","subscribe","unsubscribe","generateSubscriptionId","chartId","oneOfType"],"mappings":"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","file":"InteractiveYCoordinate.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { format } from \"d3-format\";\nimport { isDefined, noop, strokeDashTypes } from \"../utils\";\n\nimport {\n  getValueFromOverride,\n  terminate,\n  saveNodeType,\n  isHoverForInteractiveType,\n} from \"./utils\";\nimport EachInteractiveYCoordinate from \"./wrapper/EachInteractiveYCoordinate\";\nimport HoverTextNearMouse from \"./components/HoverTextNearMouse\";\n\nclass InteractiveYCoordinate extends Component {\n  constructor(props) {\n    super(props);\n    this.handleDrag = this.handleDrag.bind(this);\n    this.handleDragComplete = this.handleDragComplete.bind(this);\n    this.terminate = terminate.bind(this);\n\n    this.saveNodeType = saveNodeType.bind(this);\n    this.getSelectionState = isHoverForInteractiveType(\"yCoordinateList\")\n      .bind(this);\n\n    this.nodes = [];\n    this.state = {};\n  }\n\n  handleDrag(index, yValue) {\n    this.setState({\n      override: {\n        index,\n        yValue,\n      }\n    });\n  }\n\n  handleDragComplete(moreProps) {\n    const { override } = this.state;\n    if (isDefined(override)) {\n      const { yCoordinateList } = this.props;\n      const newAlertList = yCoordinateList\n        .map((each, idx) => {\n          const selected = (idx === override.index);\n          return selected\n            ? {\n              ...each,\n              yValue: override.yValue,\n              selected,\n            }\n            : {\n              ...each,\n              selected\n            };\n        });\n      const draggedAlert = newAlertList[override.index];\n      this.setState({\n        override: null,\n      }, () => {\n        this.props.onDragComplete(newAlertList, moreProps, draggedAlert);\n      });\n    }\n  }\n\n  handleDrawLine(xyValue) {\n    const { current } = this.state;\n\n    if (isDefined(current) && isDefined(current.start)) {\n      this.setState({\n        current: {\n          start: current.start,\n          end: xyValue,\n        }\n      });\n    }\n  }\n\n  render() {\n    const { yCoordinateList, onDelete } = this.props;\n    const { override } = this.state;\n\n    return (\n      <g>\n        {yCoordinateList.map((each, idx) => {\n          const props = each;\n          return (\n            <EachInteractiveYCoordinate\n              key={idx}\n              ref={this.saveNodeType(idx)}\n              index={idx}\n              {...props}\n              selected={each.selected}\n              yValue={getValueFromOverride(override, idx, \"yValue\", each.yValue)}\n              onDelete={onDelete}\n              onDrag={this.handleDrag}\n              onDragComplete={this.handleDragComplete}\n              edgeInteractiveCursor=\"react-stockcharts-move-cursor\"\n            />\n          );\n        })}\n      </g>\n    );\n  }\n}\n\nInteractiveYCoordinate.propTypes = {\n  onChoosePosition: PropTypes.func.isRequired,\n  onDragComplete: PropTypes.func.isRequired,\n  onSelect: PropTypes.func,\n  onDelete: PropTypes.func,\n\n  defaultPriceCoordinate: PropTypes.shape({\n    bgFill: PropTypes.string.isRequired,\n    bgOpacity: PropTypes.number.isRequired,\n\n    stroke: PropTypes.string.isRequired,\n    strokeDasharray: PropTypes.oneOf(strokeDashTypes).isRequired,\n    strokeOpacity: PropTypes.number.isRequired,\n    strokeWidth: PropTypes.number.isRequired,\n\n    textFill: PropTypes.string.isRequired,\n    fontFamily: PropTypes.string.isRequired,\n    fontWeight: PropTypes.string.isRequired,\n    fontStyle: PropTypes.string.isRequired,\n    fontSize: PropTypes.number.isRequired,\n    text: PropTypes.string.isRequired,\n    textWidth: PropTypes.number,\n    textBox: PropTypes.shape({\n      height: PropTypes.number.isRequired,\n      left: PropTypes.number.isRequired,\n      width: PropTypes.number.isRequired,\n      padding: PropTypes.shape({\n        left: PropTypes.number.isRequired,\n        right: PropTypes.number.isRequired,\n      }),\n      closeIcon: PropTypes.shape({\n        padding: PropTypes.shape({\n          left: PropTypes.number.isRequired,\n          right: PropTypes.number.isRequired,\n        }),\n        width: PropTypes.number.isRequired,\n      })\n    }).isRequired,\n    edge: PropTypes.shape({\n      stroke: PropTypes.string.isRequired,\n      strokeOpacity: PropTypes.number.isRequired,\n      strokeWidth: PropTypes.number.isRequired,\n\n      fill: PropTypes.string.isRequired,\n      fillOpacity: PropTypes.number.isRequired,\n    })\n  }).isRequired,\n\n  hoverText: PropTypes.object.isRequired,\n  yCoordinateList: PropTypes.array.isRequired,\n  enabled: PropTypes.bool.isRequired,\n};\n\nInteractiveYCoordinate.defaultProps = {\n  onChoosePosition: noop,\n  onDragComplete: noop,\n  onSelect: noop,\n  onDelete: noop,\n\n  defaultPriceCoordinate: {\n    bgFill: \"#FFFFFF\",\n    bgOpacity: 1,\n\n    stroke: \"#6574CD\",\n    strokeOpacity: 1,\n    strokeDasharray: \"ShortDash2\",\n    strokeWidth: 1,\n\n    textFill: \"#6574CD\",\n    fontFamily: \"Helvetica Neue, Helvetica, Arial, sans-serif\",\n    fontSize: 12,\n    fontStyle: \"normal\",\n    fontWeight: \"normal\",\n    text: \"Alert\",\n    textWidth: 40,\n    textBox: {\n      height: 24,\n      left: 20,\n      width: 50,\n      padding: { left: 10, right: 5 },\n      closeIcon: {\n        padding: { left: 5, right: 8 },\n        width: 8,\n      }\n    },\n    edge: {\n      stroke: \"#6574CD\",\n      strokeOpacity: 1,\n      strokeWidth: 1,\n\n      fill: \"#FFFFFF\",\n      fillOpacity: 1,\n      orient: \"right\",\n      at: \"right\",\n      arrowWidth: 10,\n      dx: 0,\n      rectWidth: 50,\n      rectHeight: 20,\n      displayFormat: format(\".2f\"),\n    }\n  },\n  hoverText: {\n    ...HoverTextNearMouse.defaultProps,\n    enable: true,\n    bgHeight: 18,\n    bgWidth: 175,\n    text: \"Click and drag the edge circles\",\n  },\n  textWidth: 40,\n  yCoordinateList: [],\n};\n\nInteractiveYCoordinate.contextTypes = {\n  subscribe: PropTypes.func.isRequired,\n  unsubscribe: PropTypes.func.isRequired,\n  generateSubscriptionId: PropTypes.func.isRequired,\n  chartId: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\n};\n\nexport default InteractiveYCoordinate;\n"]}